{"version":3,"sources":["webpack:///./src/views/User.vue","webpack:///./src/views/User.vue?2474","webpack:///./src/views/User.vue?a29a","webpack:///./src/views/User.vue?1194"],"names":["href","style","class","onSelectGroup","rowKey","columns","data-source","users","rowClassName","pagination","handleTableChange","operation","record","length","title","onUserDel","onUserTop","onUserEdit","filterDropdown","ref","placeholder","column","value","selectedKeys","type","size","handleSearch","confirm","dataIndex","icon","handleReset","clearFilters","filterIcon","filtered","undefined","name","text","searchText","searchedColumn","fragment","i","toLowerCase","key","status","checked","onUserChange","orderMap","ascend","descend","width","customRender","info","pageable","curr","index","slots","onFilterDropdownVisibleChange","visible","setTimeout","searchInput","focus","sorter","total","current","pageSize","condition","this","pageQueryUser","pageList","result","code","data","count","message","error","msg","pag","filters","sortField","columnKey","sortOrder","order","Array","user","delete","id","ret","$dialog","height","max","content","handle","component","UserForm","props","ok","top","deptId","update","console","log","orgcode","node","dataRef","components","Group","SearchOutlined","render","__scopeId"],"mappings":"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","file":"resources/js/chunk-391762d4.732acac3.js","sourcesContent":["<template>\r\n  <a-layout class=\"a-layout\">\r\n    <a-layout-sider class=\"a-layout-sider\" @contextmenu.prevent>\r\n      <Group @select=\"onSelectGroup\" />\r\n    </a-layout-sider>\r\n    <a-layout-content class=\"a-layout-content\">\r\n      <a-table\r\n        class=\"ant-table-striped\"\r\n        rowKey=\"id\"\r\n        :columns=\"columns\"\r\n        :data-source=\"users\"\r\n        :rowClassName=\"\r\n          (record, index) => (index % 2 === 1 ? 'table-striped' : null)\r\n        \"\r\n        :pagination=\"pagination\"\r\n        @change=\"handleTableChange\"\r\n      >\r\n        <!-- 操作列模板 -->\r\n        <template #operation=\"{ record }\">\r\n          <a-space>\r\n            <a-popconfirm\r\n              v-if=\"users.length\"\r\n              title=\"您确定要删除吗?\"\r\n              @confirm=\"onUserDel(record)\"\r\n            >\r\n              <a href=\"javascript:void(0);\">删除</a>\r\n            </a-popconfirm>\r\n            <a href=\"javascript:void(0);\" @click=\"onUserTop(record)\">置顶</a>\r\n            <a href=\"javascript:void(0);\" @click=\"onUserEdit(record)\">编辑</a>\r\n          </a-space>\r\n        </template>\r\n        <!-- 自定义筛选菜单 -->\r\n        <template\r\n          #filterDropdown=\"{\r\n            setSelectedKeys,\r\n            selectedKeys,\r\n            confirm,\r\n            clearFilters,\r\n            column\r\n          }\"\r\n        >\r\n          <div style=\"padding: 8px\">\r\n            <a-input\r\n              ref=\"searchInput\"\r\n              :placeholder=\"`搜索 ${column.title}`\"\r\n              :value=\"selectedKeys[0]\"\r\n              style=\"width: 188px; margin-bottom: 8px; display: block\"\r\n              @change=\"\r\n                (e) => setSelectedKeys(e.target.value ? [e.target.value] : [])\r\n              \"\r\n              @pressEnter=\"\r\n                handleSearch(selectedKeys, confirm, column.dataIndex)\r\n              \"\r\n            />\r\n            <a-button\r\n              type=\"primary\"\r\n              size=\"small\"\r\n              style=\"width: 90px; margin-right: 8px\"\r\n              @click=\"handleSearch(selectedKeys, confirm, column.dataIndex)\"\r\n            >\r\n              <template #icon><SearchOutlined /></template>\r\n              Search\r\n            </a-button>\r\n            <a-button\r\n              size=\"small\"\r\n              style=\"width: 90px\"\r\n              @click=\"handleReset(clearFilters)\"\r\n            >\r\n              Reset\r\n            </a-button>\r\n          </div>\r\n        </template>\r\n        <template #filterIcon=\"filtered\">\r\n          <search-outlined\r\n            :style=\"{ color: filtered ? '#108ee9' : undefined }\"\r\n          />\r\n        </template>\r\n        <template #name=\"{ text, column }\">\r\n          <span v-if=\"searchText && searchedColumn === column.dataIndex\">\r\n            <template\r\n              v-for=\"(fragment, i) in text\r\n                .toString()\r\n                .split(new RegExp(`(?<=${searchText})|(?=${searchText})`, 'i'))\"\r\n            >\r\n              <mark\r\n                v-if=\"fragment.toLowerCase() === searchText.toLowerCase()\"\r\n                class=\"highlight\"\r\n                :key=\"i\"\r\n              >\r\n                {{ fragment }}\r\n              </mark>\r\n              <template v-else>{{ fragment }}</template>\r\n            </template>\r\n          </span>\r\n          <template v-else>\r\n            {{ text }}\r\n          </template>\r\n        </template>\r\n        <!-- 用户状态 -->\r\n        <template #status=\"{record}\">\r\n          <a-switch :checked=\"record.status == 1\" @click=\"onUserChange(record)\" />\r\n        </template>\r\n      </a-table>\r\n    </a-layout-content>\r\n  </a-layout>\r\n</template>\r\n<script lang=\"ts\">\r\nimport { ref, unref } from 'vue'\r\nimport { message } from 'ant-design-vue'\r\nimport { Options, Vue } from 'vue-class-component'\r\nimport { SearchOutlined } from '@ant-design/icons-vue'\r\nimport { SelectEvent } from 'ant-design-vue/es/tree/Tree'\r\nimport { TableState, TableStateFilters } from 'ant-design-vue/es/table/interface'\r\nimport { User } from '@/types/User'\r\nimport Group from './Group.vue'\r\nimport UserForm from './UserForm.vue'\r\nimport Pageable from '@/types/Pageable'\r\nimport request from '@/request/UserRequest'\r\n// 分页数据类型\r\ntype Pagination = TableState['pagination'];\r\n// 排序映射\r\nconst orderMap: {[key: string]: string} = {\r\n  ascend: 'ASC',\r\n  descend: 'DESC'\r\n}\r\n@Options({\r\n  components: {\r\n    Group,\r\n    SearchOutlined\r\n  }\r\n})\r\nexport default class VueUser extends Vue {\r\n  // 用户列定义\r\n  columns = [\r\n    {\r\n      title: '序号',\r\n      dataIndex: 'number',\r\n      width: 100,\r\n      customRender: (info: {\r\n        text: string;\r\n        record: User;\r\n        index: number;\r\n      }) => {\r\n        return (this.pageable.curr - 1) * this.pageable.size + info.index + 1\r\n      }\r\n    },\r\n    {\r\n      title: '姓名',\r\n      dataIndex: 'name',\r\n      slots: {\r\n        filterDropdown: 'filterDropdown',\r\n        filterIcon: 'filterIcon',\r\n        customRender: 'name'\r\n      },\r\n      onFilterDropdownVisibleChange: (visible: boolean) => {\r\n        if (visible) {\r\n          setTimeout(() => {\r\n            const searchInput = unref(this.searchInput)\r\n            searchInput && searchInput.focus()\r\n          }, 0)\r\n        }\r\n      }\r\n    },\r\n    { title: '账号', dataIndex: 'account' },\r\n    { title: '手机', dataIndex: 'phone', width: 200 },\r\n    { title: '邮箱', dataIndex: 'email', width: 200 },\r\n    { title: '更新时间', dataIndex: 'updateTime', width: 200, sorter: true, key: 'update_time' },\r\n    {\r\n        title: '状态',\r\n        width: 100,\r\n        dataIndex: 'status',\r\n        slots: { customRender: 'status' }\r\n    },\r\n    {\r\n      title: '操作',\r\n      dataIndex: 'operation',\r\n      width: 200,\r\n      slots: { customRender: 'operation' }\r\n    }\r\n  ]\r\n\r\n  // 表格数据\r\n  users: User[] = []\r\n\r\n  // 搜索\r\n  searchInput = ref<HTMLInputElement>()\r\n  searchText = ''\r\n  searchedColumn = ''\r\n\r\n  // 分页参数定义\r\n  pagination = {\r\n    total: 200,\r\n    current: 1,\r\n    pageSize: 10\r\n  }\r\n\r\n  // 分页条件\r\n  pageable: Pageable = {\r\n    curr: this.pagination.current,\r\n    size: this.pagination.pageSize,\r\n    condition: {}\r\n  }\r\n\r\n  mounted() {\r\n    this.pageQueryUser()\r\n  }\r\n\r\n  // 分页查询用户\r\n  async pageQueryUser() {\r\n    const result = await request.pageList(this.pageable)\r\n    if (result.code === 0) {\r\n      this.users = result.data.data\r\n      this.pagination.total = result.data.count\r\n    } else {\r\n      message.error(result.msg)\r\n    }\r\n  }\r\n\r\n  // 表格变动监听\r\n  handleTableChange(pag: Pagination, filters: TableStateFilters, sorter: {field: string; order: string; columnKey: string}) {\r\n      this.pagination.current = pag?.current || 1\r\n      this.pageable.sortField = sorter.columnKey || ''\r\n      this.pageable.sortOrder = orderMap[sorter.order] || ''\r\n      this.pageable.condition.name = (filters.name instanceof Array ? filters.name[0] : '')\r\n      this.pageQueryUser()\r\n  }\r\n\r\n  /** 列表搜索 */\r\n  handleSearch(selectedKeys: string[], confirm: Function, dataIndex: string) {\r\n    confirm()\r\n    this.searchText = selectedKeys[0] || ''\r\n    this.searchedColumn = dataIndex\r\n  }\r\n\r\n  /** 查询条件重置 */\r\n  handleReset(clearFilters: Function) {\r\n    clearFilters()\r\n    this.searchText = ''\r\n  }\r\n\r\n  /** 删除人员 */\r\n  async onUserDel(user: User) {\r\n    const ret = await request.delete(user.id as number)\r\n    if (ret.code === 0) {\r\n      this.pageQueryUser()\r\n    } else {\r\n      message.error(`删除失败:${ret.msg}`)\r\n    }\r\n  }\r\n\r\n  // 编辑人员\r\n  onUserEdit(user: User) {\r\n    this.$dialog({\r\n      title: '用户信息',\r\n      width: 550,\r\n      height: 650,\r\n      max: false,\r\n      content: {\r\n        handle: true,\r\n        component: UserForm,\r\n        props: { id: user.id }\r\n      },\r\n      ok: () => {\r\n        this.pageQueryUser()\r\n        return true\r\n      }\r\n    })\r\n  }\r\n\r\n  // 人员置顶\r\n  async onUserTop(user: User) {\r\n    const ret = await request.top(user.id as number, user.deptId as number)\r\n    if (ret.code === 0) {\r\n      this.pageQueryUser()\r\n    } else {\r\n      message.error(`置顶失败:${ret.msg}`)\r\n    }\r\n  }\r\n\r\n  userStatus(user: User) {\r\n    return user.status === 1\r\n  }\r\n\r\n  /** 改变用户状态 */\r\n  async onUserChange(user: User) {\r\n    user.status = user.status === 1 ? 0 : 1\r\n    const ret = await request.update(user)\r\n    if (ret.code !== 0) {\r\n      message.error(ret.msg)\r\n      user.status = user.status === 1 ? 0 : 1\r\n    }\r\n  }\r\n\r\n  // 节点选择\r\n  onSelectGroup(selectedKeys: string[], info: SelectEvent) {\r\n    console.log(selectedKeys, info)\r\n    this.pageable.condition.orgcode = info.node.dataRef.code\r\n    this.pageQueryUser()\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.a-layout {\r\n  height: 100%;\r\n}\r\n.a-layout-sider {\r\n  width: 250px;\r\n  overflow: auto;\r\n  background-color: #fff;\r\n}\r\n.a-layout-content {\r\n  padding: 5px 2px;\r\n  overflow: auto;\r\n}\r\n.highlight {\r\n  background-color: rgb(255, 192, 105);\r\n  padding: 0px;\r\n}\r\n</style>\r\n","\r\nimport { ref, unref } from 'vue'\r\nimport { message } from 'ant-design-vue'\r\nimport { Options, Vue } from 'vue-class-component'\r\nimport { SearchOutlined } from '@ant-design/icons-vue'\r\nimport { SelectEvent } from 'ant-design-vue/es/tree/Tree'\r\nimport { TableState, TableStateFilters } from 'ant-design-vue/es/table/interface'\r\nimport { User } from '@/types/User'\r\nimport Group from './Group.vue'\r\nimport UserForm from './UserForm.vue'\r\nimport Pageable from '@/types/Pageable'\r\nimport request from '@/request/UserRequest'\r\n// 分页数据类型\r\ntype Pagination = TableState['pagination'];\r\n// 排序映射\r\nconst orderMap: {[key: string]: string} = {\r\n  ascend: 'ASC',\r\n  descend: 'DESC'\r\n}\r\n@Options({\r\n  components: {\r\n    Group,\r\n    SearchOutlined\r\n  }\r\n})\r\nexport default class VueUser extends Vue {\r\n  // 用户列定义\r\n  columns = [\r\n    {\r\n      title: '序号',\r\n      dataIndex: 'number',\r\n      width: 100,\r\n      customRender: (info: {\r\n        text: string;\r\n        record: User;\r\n        index: number;\r\n      }) => {\r\n        return (this.pageable.curr - 1) * this.pageable.size + info.index + 1\r\n      }\r\n    },\r\n    {\r\n      title: '姓名',\r\n      dataIndex: 'name',\r\n      slots: {\r\n        filterDropdown: 'filterDropdown',\r\n        filterIcon: 'filterIcon',\r\n        customRender: 'name'\r\n      },\r\n      onFilterDropdownVisibleChange: (visible: boolean) => {\r\n        if (visible) {\r\n          setTimeout(() => {\r\n            const searchInput = unref(this.searchInput)\r\n            searchInput && searchInput.focus()\r\n          }, 0)\r\n        }\r\n      }\r\n    },\r\n    { title: '账号', dataIndex: 'account' },\r\n    { title: '手机', dataIndex: 'phone', width: 200 },\r\n    { title: '邮箱', dataIndex: 'email', width: 200 },\r\n    { title: '更新时间', dataIndex: 'updateTime', width: 200, sorter: true, key: 'update_time' },\r\n    {\r\n        title: '状态',\r\n        width: 100,\r\n        dataIndex: 'status',\r\n        slots: { customRender: 'status' }\r\n    },\r\n    {\r\n      title: '操作',\r\n      dataIndex: 'operation',\r\n      width: 200,\r\n      slots: { customRender: 'operation' }\r\n    }\r\n  ]\r\n\r\n  // 表格数据\r\n  users: User[] = []\r\n\r\n  // 搜索\r\n  searchInput = ref<HTMLInputElement>()\r\n  searchText = ''\r\n  searchedColumn = ''\r\n\r\n  // 分页参数定义\r\n  pagination = {\r\n    total: 200,\r\n    current: 1,\r\n    pageSize: 10\r\n  }\r\n\r\n  // 分页条件\r\n  pageable: Pageable = {\r\n    curr: this.pagination.current,\r\n    size: this.pagination.pageSize,\r\n    condition: {}\r\n  }\r\n\r\n  mounted() {\r\n    this.pageQueryUser()\r\n  }\r\n\r\n  // 分页查询用户\r\n  async pageQueryUser() {\r\n    const result = await request.pageList(this.pageable)\r\n    if (result.code === 0) {\r\n      this.users = result.data.data\r\n      this.pagination.total = result.data.count\r\n    } else {\r\n      message.error(result.msg)\r\n    }\r\n  }\r\n\r\n  // 表格变动监听\r\n  handleTableChange(pag: Pagination, filters: TableStateFilters, sorter: {field: string; order: string; columnKey: string}) {\r\n      this.pagination.current = pag?.current || 1\r\n      this.pageable.sortField = sorter.columnKey || ''\r\n      this.pageable.sortOrder = orderMap[sorter.order] || ''\r\n      this.pageable.condition.name = (filters.name instanceof Array ? filters.name[0] : '')\r\n      this.pageQueryUser()\r\n  }\r\n\r\n  /** 列表搜索 */\r\n  handleSearch(selectedKeys: string[], confirm: Function, dataIndex: string) {\r\n    confirm()\r\n    this.searchText = selectedKeys[0] || ''\r\n    this.searchedColumn = dataIndex\r\n  }\r\n\r\n  /** 查询条件重置 */\r\n  handleReset(clearFilters: Function) {\r\n    clearFilters()\r\n    this.searchText = ''\r\n  }\r\n\r\n  /** 删除人员 */\r\n  async onUserDel(user: User) {\r\n    const ret = await request.delete(user.id as number)\r\n    if (ret.code === 0) {\r\n      this.pageQueryUser()\r\n    } else {\r\n      message.error(`删除失败:${ret.msg}`)\r\n    }\r\n  }\r\n\r\n  // 编辑人员\r\n  onUserEdit(user: User) {\r\n    this.$dialog({\r\n      title: '用户信息',\r\n      width: 550,\r\n      height: 650,\r\n      max: false,\r\n      content: {\r\n        handle: true,\r\n        component: UserForm,\r\n        props: { id: user.id }\r\n      },\r\n      ok: () => {\r\n        this.pageQueryUser()\r\n        return true\r\n      }\r\n    })\r\n  }\r\n\r\n  // 人员置顶\r\n  async onUserTop(user: User) {\r\n    const ret = await request.top(user.id as number, user.deptId as number)\r\n    if (ret.code === 0) {\r\n      this.pageQueryUser()\r\n    } else {\r\n      message.error(`置顶失败:${ret.msg}`)\r\n    }\r\n  }\r\n\r\n  userStatus(user: User) {\r\n    return user.status === 1\r\n  }\r\n\r\n  /** 改变用户状态 */\r\n  async onUserChange(user: User) {\r\n    user.status = user.status === 1 ? 0 : 1\r\n    const ret = await request.update(user)\r\n    if (ret.code !== 0) {\r\n      message.error(ret.msg)\r\n      user.status = user.status === 1 ? 0 : 1\r\n    }\r\n  }\r\n\r\n  // 节点选择\r\n  onSelectGroup(selectedKeys: string[], info: SelectEvent) {\r\n    console.log(selectedKeys, info)\r\n    this.pageable.condition.orgcode = info.node.dataRef.code\r\n    this.pageQueryUser()\r\n  }\r\n}\r\n","import { render } from \"./User.vue?vue&type=template&id=36fb2566&scoped=true\"\nimport script from \"./User.vue?vue&type=script&lang=ts\"\nexport * from \"./User.vue?vue&type=script&lang=ts\"\n\nimport \"./User.vue?vue&type=style&index=0&id=36fb2566&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-36fb2566\"\n\nexport default script","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./User.vue?vue&type=style&index=0&id=36fb2566&scoped=true&lang=css\""],"sourceRoot":""}