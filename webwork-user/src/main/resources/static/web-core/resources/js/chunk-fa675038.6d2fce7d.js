(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fa675038"],{1511:function(e,t,a){"use strict";a.r(t);a("1276"),a("ac1f"),a("d3b7"),a("25f0"),a("4d63"),a("99af");var n=a("7a23"),r=Object(n["X"])("data-v-3fa479ac");Object(n["G"])("data-v-3fa479ac");var c=Object(n["m"])("a",{href:"javascript:void(0);"},"删除",-1),o={style:{padding:"8px"}},u=Object(n["l"])(" Search "),i=Object(n["l"])(" Reset "),l={key:0};Object(n["D"])();var s=r((function(e,t,a,s,d,p){var b=Object(n["K"])("Group"),f=Object(n["K"])("a-layout-sider"),O=Object(n["K"])("a-popconfirm"),j=Object(n["K"])("a-space"),m=Object(n["K"])("a-input"),h=Object(n["K"])("SearchOutlined"),y=Object(n["K"])("a-button"),v=Object(n["K"])("search-outlined"),g=Object(n["K"])("a-switch"),k=Object(n["K"])("a-table"),x=Object(n["K"])("a-layout-content"),D=Object(n["K"])("a-layout");return Object(n["C"])(),Object(n["j"])(D,{class:"a-layout"},{default:r((function(){return[Object(n["m"])(f,{class:"a-layout-sider",onContextmenu:t[1]||(t[1]=Object(n["W"])((function(){}),["prevent"]))},{default:r((function(){return[Object(n["m"])(b,{onSelect:e.onSelectGroup},null,8,["onSelect"])]})),_:1}),Object(n["m"])(x,{class:"a-layout-content"},{default:r((function(){return[Object(n["m"])(k,{class:"ant-table-striped",rowKey:"id",columns:e.columns,"data-source":e.users,rowClassName:function(e,t){return t%2===1?"table-striped":null},pagination:e.pagination,onChange:e.handleTableChange},{operation:r((function(t){var a=t.record;return[Object(n["m"])(j,null,{default:r((function(){return[e.users.length?(Object(n["C"])(),Object(n["j"])(O,{key:0,title:"您确定要删除吗?",onConfirm:function(t){return e.onUserDel(a)}},{default:r((function(){return[c]})),_:2},1032,["onConfirm"])):Object(n["k"])("",!0),Object(n["m"])("a",{href:"javascript:void(0);",onClick:function(t){return e.onUserTop(a)}},"置顶",8,["onClick"]),Object(n["m"])("a",{href:"javascript:void(0);",onClick:function(t){return e.onUserEdit(a)}},"编辑",8,["onClick"])]})),_:2},1024)]})),filterDropdown:r((function(t){var a=t.setSelectedKeys,c=t.selectedKeys,l=t.confirm,s=t.clearFilters,d=t.column;return[Object(n["m"])("div",o,[Object(n["m"])(m,{ref:"searchInput",placeholder:"搜索 ".concat(d.title),value:c[0],style:{width:"188px","margin-bottom":"8px",display:"block"},onChange:function(e){return a(e.target.value?[e.target.value]:[])},onPressEnter:function(t){return e.handleSearch(c,l,d.dataIndex)}},null,8,["placeholder","value","onChange","onPressEnter"]),Object(n["m"])(y,{type:"primary",size:"small",style:{width:"90px","margin-right":"8px"},onClick:function(t){return e.handleSearch(c,l,d.dataIndex)}},{icon:r((function(){return[Object(n["m"])(h)]})),default:r((function(){return[u]})),_:2},1032,["onClick"]),Object(n["m"])(y,{size:"small",style:{width:"90px"},onClick:function(t){return e.handleReset(s)}},{default:r((function(){return[i]})),_:2},1032,["onClick"])])]})),filterIcon:r((function(e){return[Object(n["m"])(v,{style:{color:e?"#108ee9":void 0}},null,8,["style"])]})),name:r((function(t){var a=t.text,r=t.column;return[e.searchText&&e.searchedColumn===r.dataIndex?(Object(n["C"])(),Object(n["j"])("span",l,[(Object(n["C"])(!0),Object(n["j"])(n["b"],null,Object(n["J"])(a.toString().split(new RegExp("(?<=".concat(e.searchText,")|(?=").concat(e.searchText,")"),"i")),(function(t,a){return Object(n["C"])(),Object(n["j"])(n["b"],null,[t.toLowerCase()===e.searchText.toLowerCase()?(Object(n["C"])(),Object(n["j"])("mark",{class:"highlight",key:a},Object(n["M"])(t),1)):(Object(n["C"])(),Object(n["j"])(n["b"],{key:1},[Object(n["l"])(Object(n["M"])(t),1)],64))],64)})),256))])):(Object(n["C"])(),Object(n["j"])(n["b"],{key:1},[Object(n["l"])(Object(n["M"])(a),1)],64))]})),status:r((function(t){var a=t.record;return[Object(n["m"])(g,{checked:1==a.status,onClick:function(t){return e.onUserChange(a)}},null,8,["checked","onClick"])]})),_:1},8,["columns","data-source","rowClassName","pagination","onChange"])]})),_:1})]})),_:1})})),d=a("1da1"),p=a("d4ec"),b=a("bee2"),f=a("262e"),O=a("2caf"),j=(a("b0c0"),a("96cf"),a("9ab4")),m=a("f64c"),h=a("ce1f"),y=a("e9d5"),v=Object(n["l"])("新增部门"),g=Object(n["l"])("新增单位"),k=Object(n["l"])("更新单位"),x=Object(n["l"])(" 删除单位 "),D=Object(n["l"])("新增人员"),w=Object(n["l"])("更新部门"),_=Object(n["l"])("删除部门");function U(e,t,a,r,c,o){var u=Object(n["K"])("a-menu-item"),i=Object(n["K"])("a-menu"),l=Object(n["K"])("a-dropdown"),s=Object(n["K"])("a-tree");return Object(n["C"])(),Object(n["j"])(s,{"load-data":e.onLoadData,"tree-data":e.treeData,expandedKeys:e.expandedKeys,"onUpdate:expandedKeys":t[2]||(t[2]=function(t){return e.expandedKeys=t}),draggable:"",onSelect:e.onSelect,style:{height:"100%"},onContextmenu:t[3]||(t[3]=Object(n["W"])((function(){}),["prevent"]))},{title:Object(n["U"])((function(a){return[Object(n["m"])(l,{trigger:["contextmenu"]},{overlay:Object(n["U"])((function(){return[Object(n["m"])(i,{onClick:function(t){var n=t.key;return e.onContextMenuClick(a,n)}},{default:Object(n["U"])((function(){return[0==a.type||1==a.type?(Object(n["C"])(),Object(n["j"])(n["b"],{key:0},[Object(n["m"])(u,{key:e.contextMenuKeys.ADD_DEPT},{default:Object(n["U"])((function(){return[v]})),_:1}),Object(n["m"])(u,{key:e.contextMenuKeys.ADD_GROUP},{default:Object(n["U"])((function(){return[g]})),_:1}),Object(n["m"])(u,{key:e.contextMenuKeys.UPDATE_GROUP},{default:Object(n["U"])((function(){return[k]})),_:1}),Object(n["m"])(u,{key:e.contextMenuKeys.DELETE_GROUP},{default:Object(n["U"])((function(){return[x]})),_:1})],64)):Object(n["k"])("",!0),2==a.type?(Object(n["C"])(),Object(n["j"])(n["b"],{key:1},[Object(n["m"])(u,{key:e.contextMenuKeys.ADD_USER},{default:Object(n["U"])((function(){return[D]})),_:1}),Object(n["m"])(u,{key:e.contextMenuKeys.UPDATE_DEPT},{default:Object(n["U"])((function(){return[w]})),_:1}),Object(n["m"])(u,{key:e.contextMenuKeys.DELETE_DEPT},{default:Object(n["U"])((function(){return[_]})),_:1})],64)):Object(n["k"])("",!0)]})),_:2},1032,["onClick"])]})),default:Object(n["U"])((function(){return[Object(n["m"])("span",{onContextmenu:t[1]||(t[1]=Object(n["W"])((function(){}),["prevent"]))},Object(n["M"])(a.title),33)]})),_:2},1024)]})),_:1},8,["load-data","tree-data","expandedKeys","onSelect"])}var C=a("2909"),T=(a("a434"),a("d81d"),a("159b"),a("ed3b")),I=a("45eb"),E=a("7e84"),R=a("799e"),K=function(e){Object(f["a"])(a,e);var t=Object(O["a"])(a);function a(){return Object(p["a"])(this,a),t.apply(this,arguments)}return Object(b["a"])(a,[{key:"find",value:function(e){return Object(I["a"])(Object(E["a"])(a.prototype),"get",this).call(this,"/organization/get/".concat(e))}},{key:"delete",value:function(e){return Object(I["a"])(Object(E["a"])(a.prototype),"get",this).call(this,"/organization/delete/".concat(e))}},{key:"add",value:function(e){return Object(I["a"])(Object(E["a"])(a.prototype),"post",this).call(this,"/organization/add",e)}},{key:"update",value:function(e){return Object(I["a"])(Object(E["a"])(a.prototype),"post",this).call(this,"/organization/update",e)}},{key:"loadGroupNodes",value:function(){return Object(I["a"])(Object(E["a"])(a.prototype),"get",this).call(this,"/organization/load-nodes")}},{key:"children",value:function(e){return Object(I["a"])(Object(E["a"])(a.prototype),"get",this).call(this,"/organization/children"+(e?"?parentId=".concat(e):""))}}]),a}(R["a"]),P=new K,S=P,L=Object(n["X"])("data-v-72e7d15b");Object(n["G"])("data-v-72e7d15b");var A={key:1},G=Object(n["m"])("div",{class:"ant-upload-text"},"Upload",-1),M=Object(n["l"])("保存"),N=Object(n["l"])("取消");Object(n["D"])();var z=L((function(e,t,a,r,c,o){var u=Object(n["K"])("a-col"),i=Object(n["K"])("loading-outlined"),l=Object(n["K"])("plus-outlined"),s=Object(n["K"])("a-upload"),d=Object(n["K"])("UserOutlined"),p=Object(n["K"])("a-input"),b=Object(n["K"])("a-form-item"),f=Object(n["K"])("LockOutlined"),O=Object(n["K"])("a-row"),j=Object(n["K"])("MobileOutlined"),m=Object(n["K"])("MailOutlined"),h=Object(n["K"])("a-tree-select"),y=Object(n["K"])("a-switch"),v=Object(n["K"])("a-button"),g=Object(n["K"])("a-form");return Object(n["C"])(),Object(n["j"])(g,{ref:"formRef",colon:!1,model:e.user,rules:e.rules,"label-col":{span:4},"wrapper-col":{span:18}},{default:L((function(){return[Object(n["m"])(O,{type:"flex",gutter:8,style:{margin:"0px"}},{default:L((function(){return[Object(n["m"])(u,{span:4}),Object(n["m"])(u,{span:6},{default:L((function(){return[Object(n["m"])(s,{name:"file",data:e.avatarData,"list-type":"picture-card",class:"avatar-uploader","show-upload-list":!1,action:"/file/upload",withCredentials:!0,onChange:e.handleUploadChange,"before-upload":e.beforeUpload},{default:L((function(){return[e.user.avatar?(Object(n["C"])(),Object(n["j"])("img",{key:e.avatarKey,src:e.avatarUrl,alt:"头像"},null,8,["src"])):(Object(n["C"])(),Object(n["j"])("div",A,[e.avatarLoading?(Object(n["C"])(),Object(n["j"])(i,{key:0})):(Object(n["C"])(),Object(n["j"])(l,{key:1})),G]))]})),_:1},8,["data","onChange","before-upload"])]})),_:1}),Object(n["m"])(u,{span:12},{default:L((function(){return[Object(n["m"])(b,{"wrapper-col":{flex:"auto"},name:"name"},{default:L((function(){return[Object(n["m"])(p,{value:e.user.name,"onUpdate:value":t[1]||(t[1]=function(t){return e.user.name=t}),placeholder:"姓名"},{prefix:L((function(){return[Object(n["m"])(d,{style:{color:"rgba(0, 0, 0, 0.25)"}})]})),_:1},8,["value"])]})),_:1}),Object(n["m"])(b,{"wrapper-col":{flex:"auto"},name:"account"},{default:L((function(){return[Object(n["m"])(p,{value:e.user.account,"onUpdate:value":t[2]||(t[2]=function(t){return e.user.account=t}),placeholder:"账号"},{prefix:L((function(){return[Object(n["m"])(d,{style:{color:"rgba(0, 0, 0, 0.25)"}})]})),_:1},8,["value"])]})),_:1}),Object(n["m"])(b,{"wrapper-col":{flex:"auto"},name:"password"},{default:L((function(){return[Object(n["m"])(p,{value:e.user.password,"onUpdate:value":t[3]||(t[3]=function(t){return e.user.password=t}),type:"password",placeholder:"密码"},{prefix:L((function(){return[Object(n["m"])(f,{style:{color:"rgba(0, 0, 0, 0.25)"}})]})),_:1},8,["value"])]})),_:1})]})),_:1})]})),_:1}),Object(n["m"])(b,{label:"手机",name:"phone"},{default:L((function(){return[Object(n["m"])(p,{value:e.user.phone,"onUpdate:value":t[4]||(t[4]=function(t){return e.user.phone=t}),placeholder:"手机"},{prefix:L((function(){return[Object(n["m"])(j,{style:{color:"rgba(0, 0, 0, 0.25)"}})]})),_:1},8,["value"])]})),_:1}),Object(n["m"])(b,{label:"邮箱",name:"email"},{default:L((function(){return[Object(n["m"])(p,{value:e.user.email,"onUpdate:value":t[5]||(t[5]=function(t){return e.user.email=t}),placeholder:"邮箱"},{prefix:L((function(){return[Object(n["m"])(m,{style:{color:"rgba(0, 0, 0, 0.25)"}})]})),_:1},8,["value"])]})),_:1}),Object(n["m"])(b,{label:"职务"},{default:L((function(){return[Object(n["m"])(p,{value:e.user.post,"onUpdate:value":t[6]||(t[6]=function(t){return e.user.post=t}),placeholder:"职务"},{prefix:L((function(){return[Object(n["m"])(d,{style:{color:"rgba(0, 0, 0, 0.25)"}})]})),_:1},8,["value"])]})),_:1}),Object(n["m"])(b,{label:"部门"},{default:L((function(){return[e.treeData.length?(Object(n["C"])(),Object(n["j"])(h,{key:0,"tree-data":e.treeData,"load-data":e.onLoadData,value:e.user.deptId,"onUpdate:value":t[7]||(t[7]=function(t){return e.user.deptId=t}),"tree-default-expand-all":"",style:{width:"100%"},placeholder:"请选择用户部门","dropdown-style":{maxHeight:"400px",overflow:"auto"}},null,8,["tree-data","load-data","value"])):Object(n["k"])("",!0)]})),_:1}),Object(n["m"])(b,{label:"状态"},{default:L((function(){return[Object(n["m"])(y,{checked:1==e.user.status,onClick:e.handleUserStatus},null,8,["checked","onClick"])]})),_:1}),Object(n["m"])(b,{"wrapper-col":{span:14,offset:4}},{default:L((function(){return[Object(n["m"])(v,{type:"primary",onClick:e.onSubmit},{default:L((function(){return[M]})),_:1},8,["onClick"]),Object(n["m"])(v,{style:{"margin-left":"10px"},onClick:e.onCancel},{default:L((function(){return[N]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model","rules"])})),Q=(a("7db0"),a("a9e3"),a("edc4")),$=a("6a86"),q=a("e8db"),J=a("cc68"),F=a("47ce"),V=a("8fe6"),W=function(e){Object(f["a"])(a,e);var t=Object(O["a"])(a);function a(){return Object(p["a"])(this,a),t.apply(this,arguments)}return Object(b["a"])(a,[{key:"find",value:function(e){return Object(I["a"])(Object(E["a"])(a.prototype),"get",this).call(this,"/user/get/".concat(e))}},{key:"delete",value:function(e){return Object(I["a"])(Object(E["a"])(a.prototype),"get",this).call(this,"/user/delete/".concat(e))}},{key:"add",value:function(e){return Object(I["a"])(Object(E["a"])(a.prototype),"post",this).call(this,"/user/add",e)}},{key:"update",value:function(e){return Object(I["a"])(Object(E["a"])(a.prototype),"post",this).call(this,"/user/update",e)}},{key:"top",value:function(e,t){return Object(I["a"])(Object(E["a"])(a.prototype),"get",this).call(this,"/user/top?userId=".concat(e,"&deptId=").concat(t))}},{key:"pageList",value:function(e){return Object(I["a"])(Object(E["a"])(a.prototype),"post",this).call(this,"/user/page",e)}}]),a}(R["a"]),H=new W,X=H,B=function(e){Object(f["a"])(a,e);var t=Object(O["a"])(a);function a(){var e;return Object(p["a"])(this,a),e=t.apply(this,arguments),e.user={status:1,deptId:e.deptId},e.avatarKey=Math.random(),e.avatarLoading=!1,e.treeData=[],e.formRef=Object(n["I"])(),e.rules={name:[{required:!0,message:"请输入姓名",trigger:"blur"},{max:20,message:"最多输入20个字符"}],account:[{required:!0,message:"请输入账号",trigger:"blur"},{max:20,message:"最多输入20个字符"}],post:[{max:20,message:"最多输入20个字符"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:15,message:"密码为6-15位字符串",trigger:"blur"}],phone:[{pattern:/^1[0-9]{10}$/,message:"手机号码错误",trigger:"blur"}],email:[{pattern:/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,})$/,message:"邮箱地址错误",trigger:"blur"},{max:50,message:"最多输入50个字符"}]},e.handleUploadChange=function(t){if("uploading"===t.file.status)return e.avatarLoading=!0,!1;var a,n;(e.avatarLoading=!1,"done"===t.file.status)&&(0===(null===(a=t.file.response)||void 0===a?void 0:a.code)?(e.user.avatar=t.file.response.data.objectName,e.avatarKey=Math.random()):m["a"].error(null===(n=t.file.response)||void 0===n?void 0:n.msg));"error"===t.file.status&&m["a"].error("上传失败")},e}return Object(b["a"])(a,[{key:"avatarUrl",get:function(){return"/file/download/thumb/".concat(this.user.avatar)}},{key:"avatarData",get:function(){return{objectName:this.user.avatar||""}}},{key:"beforeUpload",value:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||m["a"].error("You can only upload JPG file!");var a=e.size/1024/1024<2;return a||m["a"].error("Image must smaller than 2MB!"),t&&a}},{key:"mounted",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.children();case 2:t=e.sent,0===t.code?this.treeData=this.toChildren(t):m["a"].error(t.msg),this.id&&X.find(this.id).then((function(e){0===e.code?a.user=e.data:m["a"].error(e.msg)}));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onLoadData",value:function(e){var t=this;return new Promise((function(a){if(e.dataRef.children)return a(),!1;S.children(e.dataRef.rawId).then((function(n){e.dataRef.children=t.toChildren(n),t.treeData=Object(C["a"])(t.treeData),a(),t.user.deptId=t.user.deptId||0}))}))}},{key:"onSubmit",value:function(){var e=this,t=Object(n["Q"])(this.formRef);t&&t.validate().then(Object(d["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.user.id){t.next=6;break}return t.next=3,X.add(Object(n["N"])(e.user));case 3:a=t.sent,t.next=9;break;case 6:return t.next=8,X.update(Object(n["N"])(e.user));case 8:a=t.sent;case 9:0===a.code?e.dialog._ok():m["a"].error(a.msg);case 10:case"end":return t.stop()}}),t)})))).catch((function(e){console.log("error",e)}))}},{key:"onCancel",value:function(){this.dialog._close()}},{key:"handleUserStatus",value:function(){this.user.status=1===this.user.status?0:1}},{key:"toChildren",value:function(e){return e.data.map((function(e){return{key:e.id,rawId:e.rawId,type:e.type,value:e.id,title:e.name,code:e.code,isLeaf:2===e.type,selectable:2===e.type}}))}}]),a}(h["b"]);B=Object(j["a"])([Object(h["a"])({components:{UserOutlined:Q["a"],LockOutlined:$["a"],MobileOutlined:q["a"],MailOutlined:J["a"],PlusOutlined:F["a"],LoadingOutlined:V["a"]},props:{id:{type:Number},deptId:{type:Number},dialog:Object}})],B);var Y=B;a("31e9");Y.render=z,Y.__scopeId="data-v-72e7d15b";var Z=Y,ee=Object(n["l"])("是"),te=Object(n["l"])("否"),ae=Object(n["l"])("提交"),ne=Object(n["l"])("取消");function re(e,t,a,r,c,o){var u=Object(n["K"])("a-input"),i=Object(n["K"])("a-form-item"),l=Object(n["K"])("a-tree-select"),s=Object(n["K"])("a-radio"),d=Object(n["K"])("a-radio-group"),p=Object(n["K"])("a-switch"),b=Object(n["K"])("a-button"),f=Object(n["K"])("a-form");return Object(n["C"])(),Object(n["j"])(f,{ref:"formRef",model:e.formData,rules:e.rules,"label-col":{span:4},"wrapper-col":{span:18},style:{"margin-top":"15px"}},{default:Object(n["U"])((function(){return[Object(n["m"])(i,{label:"节点名称",name:"name"},{default:Object(n["U"])((function(){return[Object(n["m"])(u,{value:e.formData.name,"onUpdate:value":t[1]||(t[1]=function(t){return e.formData.name=t})},null,8,["value"])]})),_:1}),e.isTop?Object(n["k"])("",!0):(Object(n["C"])(),Object(n["j"])(i,{key:0,label:"上级单位",name:"parentId"},{default:Object(n["U"])((function(){return[Object(n["m"])(l,{value:e.formData.parentId,"onUpdate:value":t[2]||(t[2]=function(t){return e.formData.parentId=t}),defaultValue:e.formData.parentName,disabled:!!e.id,"tree-data":e.treeData,"load-data":e.onLoadData,onTreeExpand:e.onSelectTreeExpand,"tree-default-expand-all":"",style:{width:"100%"},placeholder:"请选择上级单位","dropdown-style":{maxHeight:"400px",overflow:"auto"}},null,8,["value","defaultValue","disabled","tree-data","load-data","onTreeExpand"])]})),_:1})),e.isTop||1!=e.type?Object(n["k"])("",!0):(Object(n["C"])(),Object(n["j"])(i,{key:1,label:"虚拟节点",name:"virtual"},{default:Object(n["U"])((function(){return[Object(n["m"])(d,{value:e.formData.virtual,"onUpdate:value":t[3]||(t[3]=function(t){return e.formData.virtual=t})},{default:Object(n["U"])((function(){return[Object(n["m"])(s,{value:!0},{default:Object(n["U"])((function(){return[ee]})),_:1}),Object(n["m"])(s,{value:!1},{default:Object(n["U"])((function(){return[te]})),_:1})]})),_:1},8,["value"])]})),_:1})),e.isTop?Object(n["k"])("",!0):(Object(n["C"])(),Object(n["j"])(i,{key:2,label:"节点状态",name:"enabled"},{default:Object(n["U"])((function(){return[Object(n["m"])(p,{checked:e.formData.enabled,"onUpdate:checked":t[4]||(t[4]=function(t){return e.formData.enabled=t})},null,8,["checked"])]})),_:1})),Object(n["m"])(i,{"wrapper-col":{span:14,offset:4}},{default:Object(n["U"])((function(){return[Object(n["m"])(b,{type:"primary",onClick:e.onSubmit},{default:Object(n["U"])((function(){return[ae]})),_:1},8,["onClick"]),Object(n["m"])(b,{style:{"margin-left":"10px"},onClick:e.onCancel},{default:Object(n["U"])((function(){return[ne]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model","rules"])}var ce=a("5530"),oe=a("a1e9"),ue=a("499d"),ie=function(e){Object(f["a"])(a,e);var t=Object(O["a"])(a);function a(){var e;return Object(p["a"])(this,a),e=t.apply(this,arguments),e.treeData=[],e.formData={id:e.id,enabled:!0,virtual:!1,parentId:e.parentId,parentType:e.parentType,parentName:e.parentName},e.formRef=Object(oe["k"])(),e.rules={name:[{required:!0,message:"请输入名称",trigger:"blur"},{max:50,message:"名称最多50个字符"}],parentId:[{required:!0,message:"请选择上级单位",trigger:"blur",type:"number"}]},e}return Object(b["a"])(a,[{key:"isTop",get:function(){return!(this.parentId||this.formData.parentId)}},{key:"mounted",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.loadGroupNodes();case 2:if(t=e.sent,0===t.code){e.next=6;break}return m["a"].error(t.msg),e.abrupt("return",!1);case 6:if(this.treeData=this.toAntTreeNodes(t.data),!this.id){e.next=15;break}return e.next=10,S.find(this.id);case 10:if(a=e.sent,0===a.code){e.next=14;break}return m["a"].error(a.msg),e.abrupt("return",!1);case 14:this.formData=Object(ce["a"])(Object(ce["a"])({},this.formData),a.data);case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onLoadData",value:function(e){var t=this;return new Promise((function(a){if(e.dataRef.children)return a(),!1;S.children(e.dataRef.rawId).then((function(n){e.dataRef.children=t.toChildren(n),t.treeData=Object(C["a"])(t.treeData),a()}))}))}},{key:"onSelectTreeExpand",value:function(e){console.log(e)}},{key:"onSubmit",value:function(){var e=this,t=Object(oe["u"])(this.formRef);t&&t.validate().then(Object(d["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=Object(ce["a"])({},Object(oe["p"])(e.formData)),a.type=a.virtual?0:e.type,a.status=a.enabled?1:0,delete a.virtual,delete a.enabled,e.id){t.next=12;break}return t.next=8,S.add(a);case 8:n=t.sent,a.id=n.data,t.next=15;break;case 12:return t.next=14,S.update(a);case 14:n=t.sent;case 15:0===n.code?e.dialog._ok(a):m["a"].error("错误:".concat(n.msg));case 16:case"end":return t.stop()}}),t)})))).catch((function(e){console.log("error",e)}))}},{key:"onCancel",value:function(){this.dialog._close()}},{key:"toChildren",value:function(e){return e.data.map((function(e){return{key:e.id,rawId:e.rawId,type:e.type,value:e.id,title:e.name,code:e.code,isLeaf:e.type===ue["a"].DEPT,selectable:e.type===ue["a"].GROUP}}))}},{key:"toAntTreeNodes",value:function(e){var t=this;return e.map((function(e){return{key:e.id,rawId:e.rawId,type:e.type,value:e.id,title:e.name,code:e.code,isLeaf:e.type===ue["a"].DEPT,selectable:e.type===ue["a"].GROUP,children:t.toAntTreeNodes(e.children)}}))}}]),a}(h["b"]);ie=Object(j["a"])([Object(h["a"])({props:{id:{type:Number},type:{type:Number},parentId:{type:Number},parentType:{type:Number},parentName:{type:String},dialog:Object}})],ie);var le=ie;le.render=re;var se,de=le;(function(e){e[e["ADD_USER"]=0]="ADD_USER",e[e["ADD_DEPT"]=1]="ADD_DEPT",e[e["ADD_GROUP"]=2]="ADD_GROUP",e[e["UPDATE_DEPT"]=3]="UPDATE_DEPT",e[e["UPDATE_GROUP"]=4]="UPDATE_GROUP",e[e["DELETE_DEPT"]=5]="DELETE_DEPT",e[e["DELETE_GROUP"]=6]="DELETE_GROUP"})(se||(se={}));var pe=function(e){Object(f["a"])(a,e);var t=Object(O["a"])(a);function a(){var e;return Object(p["a"])(this,a),e=t.apply(this,arguments),e.treeData=[],e.expandedKeys=[],e.contextMenuKeys=se,e}return Object(b["a"])(a,[{key:"mounted",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.children();case 2:if(t=e.sent,0===t.code){e.next=6;break}return m["a"].error(t.msg),e.abrupt("return",!1);case 6:this.treeData=this.toChildren(t);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onLoadData",value:function(e){var t=this;return new Promise((function(a){if(e.dataRef.children)return a(),!1;S.children(e.dataRef.rawId).then((function(n){e.dataRef.children=t.toChildren(n),t.treeData=Object(C["a"])(t.treeData),a()}))}))}},{key:"onSelect",value:function(e,t){this.$emit("select",e,t)}},{key:"onContextMenuClick",value:function(e,t){var a,n,r=this;if(se.ADD_DEPT===t)a="新增部门",n={type:ue["a"].DEPT,parentId:e.rawId,parentType:e.type,parentName:e.title};else if(se.ADD_GROUP===t)a="新增单位",n={type:ue["a"].GROUP,parentId:e.rawId,parentType:e.type,parentName:e.title};else if(se.UPDATE_DEPT===t)a="更新部门",n={id:e.rawId,type:ue["a"].DEPT};else{if(se.UPDATE_GROUP!==t)return se.DELETE_DEPT===t||se.DELETE_GROUP===t?(T["a"].confirm({title:"您确定要删除<".concat(e.title,">吗?"),okType:"danger",onOk:function(){S.delete(e.rawId).then((function(t){0===t.code?(m["a"].success("删除成功"),r.loop(r.treeData,e.key,(function(e,t,a){a.splice(t,1)}))):m["a"].error("删除失败:"+t.msg)})).catch((function(e){m["a"].error(e.message)}))}}),!1):se.ADD_USER===t?(this.$dialog({title:"新增用户",width:550,height:650,max:!1,content:{handle:!0,component:Z,props:{deptId:e.rawId,deptName:e.title}},ok:function(){return r.$emit("select",[e.key],{node:{dataRef:{code:e.code}}}),!0}}),!1):(console.log("unknow menukey ".concat(t)),!1);a="更新单位",n={id:e.rawId,type:ue["a"].GROUP}}this.$dialog({title:a,width:550,height:400,content:{handle:!0,props:n,component:de},ok:function(t){var a=t[0],c="".concat(a.type,"_").concat(a.id),o="".concat(n.parentType,"_").concat(n.parentId),u={id:c,rawId:a.id,type:a.type,name:a.name,code:a.code};return e.key===c?e.dataRef.title=a.name:e.key===o?e.dataRef.children?e.dataRef.children.push(r.dataToTreeDataItem(u)):r.onLoadData(e):r.loop(r.treeData,o,(function(e,t,a){e.children&&e.children.push(r.dataToTreeDataItem(u))})),!0}})}},{key:"watchExpandedKeys",value:function(e,t){console.log("expandedKeys",e,t)}},{key:"toChildren",value:function(e){var t=this;return e.data.map((function(e){return t.dataToTreeDataItem(e)}))}},{key:"dataToTreeDataItem",value:function(e){return{key:e.id,type:e.type,title:e.name,code:e.code,rawId:e.rawId,isLeaf:e.type===ue["a"].DEPT}}},{key:"loop",value:function(e,t,a){var n=this;e.forEach((function(e,r,c){return e.key===t?a(e,r,c):e.children?n.loop(e.children,t,a):void 0}))}}]),a}(h["b"]);pe=Object(j["a"])([Object(h["a"])({emits:["select"]})],pe);var be=pe;be.render=U;var fe=be,Oe={ascend:"ASC",descend:"DESC"},je=function(e){Object(f["a"])(a,e);var t=Object(O["a"])(a);function a(){var e;return Object(p["a"])(this,a),e=t.apply(this,arguments),e.columns=[{title:"序号",dataIndex:"number",width:100,customRender:function(t){return(e.pageable.curr-1)*e.pageable.size+t.index+1}},{title:"姓名",dataIndex:"name",slots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon",customRender:"name"},onFilterDropdownVisibleChange:function(t){t&&setTimeout((function(){var t=Object(n["Q"])(e.searchInput);t&&t.focus()}),0)}},{title:"账号",dataIndex:"account"},{title:"手机",dataIndex:"phone",width:200},{title:"邮箱",dataIndex:"email",width:200},{title:"更新时间",dataIndex:"updateTime",width:200,sorter:!0,key:"update_time"},{title:"状态",width:100,dataIndex:"status",slots:{customRender:"status"}},{title:"操作",dataIndex:"operation",width:200,slots:{customRender:"operation"}}],e.users=[],e.searchInput=Object(n["I"])(),e.searchText="",e.searchedColumn="",e.pagination={total:200,current:1,pageSize:10},e.pageable={curr:e.pagination.current,size:e.pagination.pageSize,condition:{}},e}return Object(b["a"])(a,[{key:"mounted",value:function(){this.pageQueryUser()}},{key:"pageQueryUser",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,X.pageList(this.pageable);case 2:t=e.sent,0===t.code?(this.users=t.data.data,this.pagination.total=t.data.count):m["a"].error(t.msg);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleTableChange",value:function(e,t,a){this.pagination.current=(null===e||void 0===e?void 0:e.current)||1,this.pageable.curr=this.pagination.current,this.pageable.sortField=a.columnKey||"",this.pageable.sortOrder=Oe[a.order]||"",this.pageable.condition.name=t.name instanceof Array?t.name[0]:"",this.pageQueryUser()}},{key:"handleSearch",value:function(e,t,a){t(),this.searchText=e[0]||"",this.searchedColumn=a}},{key:"handleReset",value:function(e){e(),this.searchText=""}},{key:"onUserDel",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,X.delete(t.id);case 2:a=e.sent,0===a.code?this.pageQueryUser():m["a"].error("删除失败:".concat(a.msg));case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onUserEdit",value:function(e){var t=this;this.$dialog({title:"用户信息",width:550,height:650,max:!1,content:{handle:!0,component:Z,props:{id:e.id}},ok:function(){return t.pageQueryUser(),!0}})}},{key:"onUserTop",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,X.top(t.id,t.deptId);case 2:a=e.sent,0===a.code?this.pageQueryUser():m["a"].error("置顶失败:".concat(a.msg));case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"userStatus",value:function(e){return 1===e.status}},{key:"onUserChange",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.status=1===t.status?0:1,e.next=3,X.update(t);case 3:a=e.sent,0!==a.code&&(m["a"].error(a.msg),t.status=1===t.status?0:1);case 5:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onSelectGroup",value:function(e,t){console.log(e,t),this.pageable.condition.orgcode=t.node.dataRef.code,this.pageQueryUser()}}]),a}(h["b"]);je=Object(j["a"])([Object(h["a"])({components:{Group:fe,SearchOutlined:y["a"]}})],je);var me=je;a("1abe");me.render=s,me.__scopeId="data-v-3fa479ac";t["default"]=me},"1abe":function(e,t,a){"use strict";a("aa81")},"31e9":function(e,t,a){"use strict";a("9a74")},"9a74":function(e,t,a){},a434:function(e,t,a){"use strict";var n=a("23e7"),r=a("23cb"),c=a("a691"),o=a("50c4"),u=a("7b0b"),i=a("65f0"),l=a("8418"),s=a("1dde"),d=s("splice"),p=Math.max,b=Math.min,f=9007199254740991,O="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var a,n,s,d,j,m,h=u(this),y=o(h.length),v=r(e,y),g=arguments.length;if(0===g?a=n=0:1===g?(a=0,n=y-v):(a=g-2,n=b(p(c(t),0),y-v)),y+a-n>f)throw TypeError(O);for(s=i(h,n),d=0;d<n;d++)j=v+d,j in h&&l(s,d,h[j]);if(s.length=n,a<n){for(d=v;d<y-n;d++)j=d+n,m=d+a,j in h?h[m]=h[j]:delete h[m];for(d=y;d>y-n+a;d--)delete h[d-1]}else if(a>n)for(d=y-n;d>v;d--)j=d+n-1,m=d+a-1,j in h?h[m]=h[j]:delete h[m];for(d=0;d<a;d++)h[d+v]=arguments[d+2];return h.length=y-n+a,s}})},aa81:function(e,t,a){}}]);
//# sourceMappingURL=chunk-fa675038.6d2fce7d.js.map