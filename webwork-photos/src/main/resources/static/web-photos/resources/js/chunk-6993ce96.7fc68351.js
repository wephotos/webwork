(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6993ce96"],{"159b":function(e,t,n){var o=n("da84"),a=n("fdbc"),r=n("17c2"),c=n("9112");for(var i in a){var u=o[i],l=u&&u.prototype;if(l&&l.forEach!==r)try{c(l,"forEach",r)}catch(f){l.forEach=r}}},"17c2":function(e,t,n){"use strict";var o=n("b727").forEach,a=n("a640"),r=a("forEach");e.exports=r?[].forEach:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}},"189f":function(e,t,n){"use strict";n("8bd5")},8418:function(e,t,n){"use strict";var o=n("c04e"),a=n("9bf2"),r=n("5c6c");e.exports=function(e,t,n){var c=o(t);c in e?a.f(e,c,r(0,n)):e[c]=n}},"8bd5":function(e,t,n){},a640:function(e,t,n){"use strict";var o=n("d039");e.exports=function(e,t){var n=[][e];return!!n&&o((function(){n.call(null,t||function(){throw 1},1)}))}},b64b:function(e,t,n){var o=n("23e7"),a=n("7b0b"),r=n("df75"),c=n("d039"),i=c((function(){r(1)}));o({target:"Object",stat:!0,forced:i},{keys:function(e){return r(a(e))}})},dbb4:function(e,t,n){var o=n("23e7"),a=n("83ab"),r=n("56ef"),c=n("fc6a"),i=n("06cf"),u=n("8418");o({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(e){var t,n,o=c(e),a=i.f,l=r(o),f={},b=0;while(l.length>b)n=a(o,t=l[b++]),void 0!==n&&u(f,t,n);return f}})},ee18:function(e,t,n){"use strict";n.r(t);n("b0c0"),n("a4d3"),n("e01a");var o=n("7a23"),a=Object(o["W"])("data-v-76330f4c");Object(o["G"])("data-v-76330f4c");var r=Object(o["l"])("返回"),c=Object(o["l"])(" 上传照片 ");Object(o["D"])();var i=a((function(e,t,n,i,u,l){var f=Object(o["K"])("a-button"),b=Object(o["K"])("upload-outlined"),s=Object(o["K"])("a-upload"),d=Object(o["K"])("a-space"),p=Object(o["K"])("a-layout-header"),m=Object(o["K"])("a-empty"),O=Object(o["K"])("a-image"),h=Object(o["K"])("file-image-outlined"),v=Object(o["K"])("edit-outlined"),j=Object(o["K"])("delete-outlined"),g=Object(o["K"])("a-popconfirm"),y=Object(o["K"])("a-card"),w=Object(o["K"])("a-input"),k=Object(o["K"])("a-form-item"),D=Object(o["K"])("a-textarea"),P=Object(o["K"])("a-form"),C=Object(o["K"])("a-modal"),I=Object(o["K"])("a-layout-content"),K=Object(o["K"])("a-layout");return Object(o["C"])(),Object(o["j"])(K,null,{default:a((function(){return[Object(o["m"])(p,null,{default:a((function(){return[Object(o["m"])(d,null,{default:a((function(){return[Object(o["m"])(f,{size:"default",onClick:e.handleBack},{default:a((function(){return[r]})),_:1},8,["onClick"]),Object(o["m"])(s,{name:"file",action:"/album-photo/upload",accept:"image/*",multiple:!0,data:{albumId:e.albumId},withCredentials:!0,"show-upload-list":!1,"before-upload":e.beforeUpload,onChange:e.handleUpload},{default:a((function(){return[Object(o["m"])(f,null,{default:a((function(){return[Object(o["m"])(b),c]})),_:1})]})),_:1},8,["data","before-upload","onChange"])]})),_:1})]})),_:1}),Object(o["m"])(I,null,{default:a((function(){return[0===e.photos.length?(Object(o["C"])(),Object(o["j"])(m,{key:0,description:null})):Object(o["k"])("",!0),(Object(o["C"])(!0),Object(o["j"])(o["b"],null,Object(o["J"])(e.photos,(function(t,n){return Object(o["C"])(),Object(o["j"])(y,{hoverable:"",key:t.id},{cover:a((function(){return[Object(o["m"])(O,{alt:t.name,preview:{visible:!1},src:e.photoSrc(t),onClick:function(t){return e.onView(n)}},null,8,["alt","src","onClick"])]})),actions:a((function(){return[Object(o["m"])(h,{key:"cover",title:"设为封面",onClick:function(n){return e.onCover(t)}},null,8,["onClick"]),Object(o["m"])(v,{key:"edit",title:"编辑",onClick:function(n){return e.onEdit(t)}},null,8,["onClick"]),Object(o["m"])(g,{title:"您确定要删除这张照片吗？","ok-text":"是","cancel-text":"否",onConfirm:function(n){return e.onDelete(t)}},{default:a((function(){return[Object(o["m"])(j,{key:"delete",title:"删除照片"})]})),_:2},1032,["onConfirm"])]})),_:2},1024)})),128)),Object(o["m"])(C,{visible:e.photoInfoDialog.visible,"onUpdate:visible":t[3]||(t[3]=function(t){return e.photoInfoDialog.visible=t}),title:e.photoInfoDialog.title,"confirm-loading":e.photoInfoDialog.confirmLoading,onOk:e.onSavePhoto},{default:a((function(){return[Object(o["m"])(P,{ref:"formRef",model:e.formData,rules:e.rules,colon:!1,"label-col":{span:3},"wrapper-col":{span:21}},{default:a((function(){return[Object(o["m"])(k,{label:"名称",name:"name"},{default:a((function(){return[Object(o["m"])(w,{value:e.formData.name,"onUpdate:value":t[1]||(t[1]=function(t){return e.formData.name=t}),placeholder:"照片名称",size:"large","show-count":"",maxlength:10},null,8,["value"])]})),_:1}),Object(o["m"])(k,{label:"描述",name:"description"},{default:a((function(){return[Object(o["m"])(D,{value:e.formData.description,"onUpdate:value":t[2]||(t[2]=function(t){return e.formData.description=t}),placeholder:"照片描述",rows:4},null,8,["value"])]})),_:1}),Object(o["m"])(k,{label:"地址",name:"address"},{default:a((function(){return[Object(o["m"])(w,{value:e.photoSrc(e.formData),bordered:!1,disabled:!0,placeholder:"照片对象地址"},null,8,["value"])]})),_:1})]})),_:1},8,["model","rules"])]})),_:1},8,["visible","title","confirm-loading","onOk"])]})),_:1})]})),_:1})})),u=n("1da1");n("b64b"),n("4de4"),n("e439"),n("159b"),n("dbb4");function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s=n("d4ec"),d=n("bee2"),p=n("262e"),m=n("2caf"),O=(n("96cf"),n("a9e3"),n("2ca0"),n("9ab4")),h=n("ba98"),v=n("b1c8"),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},g=j,y=n("b3f0");function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){k(e,t,n[t])}))}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D=function(e,t){var n=w({},e,t.attrs);return o["m"](y["a"],o["t"](n,{icon:g}),null)};D.displayName="UploadOutlined",D.inheritAttrs=!1;var P=D,C={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M553.1 509.1l-77.8 99.2-41.1-52.4a8 8 0 00-12.6 0l-99.8 127.2a7.98 7.98 0 006.3 12.9H696c6.7 0 10.4-7.7 6.3-12.9l-136.5-174a8.1 8.1 0 00-12.7 0zM360 442a40 40 0 1080 0 40 40 0 10-80 0zm494.6-153.4L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-image",theme:"outlined"},I=C;function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){_(e,t,n[t])}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=function(e,t){var n=K({},e,t.attrs);return o["m"](y["a"],o["t"](n,{icon:I}),null)};E.displayName="FileImageOutlined",E.inheritAttrs=!1;var x=E,S=n("ce1f"),z=n("45eb"),V=n("7e84"),U=n("a6a9"),N=function(e){Object(p["a"])(n,e);var t=Object(m["a"])(n);function n(){return Object(s["a"])(this,n),t.apply(this,arguments)}return Object(d["a"])(n,[{key:"update",value:function(e){return Object(z["a"])(Object(V["a"])(n.prototype),"post",this).call(this,"/album-photo/update",e)}},{key:"deletePhoto",value:function(e){return Object(z["a"])(Object(V["a"])(n.prototype),"get",this).call(this,"/album-photo/delete/".concat(e))}},{key:"listQuery",value:function(e){return Object(z["a"])(Object(V["a"])(n.prototype),"post",this).call(this,"/album-photo/list-query",e)}}]),n}(U["a"]),H=new N,M=H,B=n("7156"),L=n("f64c"),R=function(e){Object(p["a"])(n,e);var t=Object(m["a"])(n);function n(){var e;return Object(s["a"])(this,n),e=t.apply(this,arguments),e.formRef=Object(o["I"])(),e.photos=[],e.preview={visible:!1,onVisibleChange:function(t){e.preview.visible=t}},e.photoInfoDialog={title:"照片信息",visible:!1,confirmLoading:!1},e.formData={},e.rules={name:[{required:!0,message:"照片名称不能为空"},{max:10,message:"照片名称最多10个字符"}],description:[{max:100,message:"照片描述最多100个字符"}]},e.albumId=0,e}return Object(d["a"])(n,[{key:"mounted",value:function(){var e=this;this.albumId=Number(this.$route.query.albumId),this.albumId&&M.listQuery({albumId:this.albumId}).then((function(t){0===t.code?e.photos=t.data:L["a"].error(t.msg)}))}},{key:"onView",value:function(e){this.preview.visible=!0}},{key:"onEdit",value:function(e){this.formData=b({},e),this.photoInfoDialog.visible=!0}},{key:"onCover",value:function(e){var t={cover:e.thumbObjectName,albumId:this.albumId};B["a"].setCover(t).then((function(t){0===t.code?L["a"].success("照片<".concat(e.name,">已设为相册封面")):L["a"].error(t.msg)}))}},{key:"onDelete",value:function(e){var t=this;M.deletePhoto(e.id).then((function(n){0!==n.code?L["a"].error(n.msg):(L["a"].success("删除成功"),t.photos=t.photos.filter((function(t){return t.id!==e.id})))}))}},{key:"onSavePhoto",value:function(){var e=this,t=Object(o["Q"])(this.formRef);t&&t.validate().then(Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.photos.forEach((function(t){t.id===e.formData.id&&M.update(Object(o["N"])(e.formData)).then((function(n){0!==n.code?L["a"].error(n.msg):(t.name=e.formData.name,t.description=e.formData.description,e.photoInfoDialog.visible=!1)}))}));case 1:case"end":return t.stop()}}),t)})))).catch((function(e){console.log("error",e)}))}},{key:"handleBack",value:function(){this.$router.back()}},{key:"photoSrc",value:function(e){var t;return null!==(t=e.thumbObjectName)&&void 0!==t&&t.startsWith("http")?e.thumbObjectName:"/file/download/"+e.thumbObjectName}},{key:"beforeUpload",value:function(e){var t,n=e.size/1024/1024<5;return n||L["a"].error("上传照片不能大于 5MB!"),n&&(null===(t=e.type)||void 0===t?void 0:t.startsWith("image/"))}},{key:"handleUpload",value:function(e){if("uploading"===e.file.status)return!1;var t,n;"done"===e.file.status&&(0===(null===(t=e.file.response)||void 0===t?void 0:t.code)?this.photos.push(e.file.response.data):L["a"].error(null===(n=e.file.response)||void 0===n?void 0:n.msg));"error"===e.file.status&&L["a"].error("上传失败")}}]),n}(S["b"]);R=Object(O["a"])([Object(S["a"])({components:{EditOutlined:h["a"],DeleteOutlined:v["a"],UploadOutlined:P,FileImageOutlined:x}})],R);var q=R;n("189f");q.render=i,q.__scopeId="data-v-76330f4c";t["default"]=q}}]);
//# sourceMappingURL=chunk-6993ce96.7fc68351.js.map